
		/*
 * Copyright (C) 2007 Trivantis Corporation
 */

	
var finishCalled=false;var autoCommit=false;function MySetValue(A,B) {var C=getTitleMgrHandle();if(C) C.setVariable(A,B,0);LMSSetValue(A,B);};function loadPage(){var A=readVariable('TrivantisSCORMTimer',0);saveVariable('TrivantisEPS','F');if(A==0||!LMSIsInitialized()){LMSInitialize();var B=String(LMSGetValue("cmi.core.lesson_status"));B=B.toLowerCase();if (B=="not attempted"){MySetValue("cmi.core.lesson_status","incomplete");LMSCommit();};startTimer();return true;}else return false;};function startTimer() {var A=new Date().getTime();saveVariable('TrivantisSCORMTimer',A);};function computeTime() {var A=readVariable('TrivantisSCORMTimer',0);if (A!=0) {var B=new Date().getTime();var C=B-A;var D=convertTotalMills(C);}else D="00:00:00.0";MySetValue("cmi.core.session_time",D);};function doBack() {MySetValue("cmi.core.exit","suspend");computeTime();saveVariable('TrivantisEPS','T');var A;A=LMSCommit();finishCalled=true;A=LMSFinish();saveVariable('TrivantisSCORMTimer',0);};function doContinue(A) {MySetValue("cmi.core.exit","");var B=String(LMSGetValue("cmi.core.lesson_mode"));B=B.toLowerCase();if (B!="review"&&B!="browse") MySetValue("cmi.core.lesson_status",A);computeTime();saveVariable('TrivantisEPS','T');var C;C=LMSCommit();finishCalled=true;C=LMSFinish();saveVariable('TrivantisSCORMTimer',0);};function doQuit(A){computeTime();saveVariable('TrivantisEPS','T');var B;B=LMSCommit();finishCalled=true;B=LMSFinish();saveVariable('TrivantisSCORMTimer',0);if(A&&window.myTop) myTop.close();};function unloadPage(A,B){var C=readVariable('TrivantisEPS','F');if (C!='T'){if (window.name.indexOf('Trivantis_')==-1) trivScormQuit(A,B,false);}else if (finishCalled!=true&&autoCommit==true){computeTime();LMSCommit();}};function convertTotalMills(A) {var B=0;var C=0;var D=0;while(A>=3600000) {D+=1;A-=3600000;}while(A>=60000){C+=1;A-=60000;}while (A>=1000){B+=1;A-=1000;};if (D<10) D="0"+D;if (C<10) C="0"+C;if (B<10) B="0"+B;var E=D+":"+C+":"+B;return E;};function putSCORMInteractions(A,B,C,D,E,F,G,H,I,J) {var K=parseInt(LMSGetValue('cmi.interactions._count'),10);var L='cmi.interactions.'+K;if(A)   LMSSetValue(L+'.id',A);if(B)  LMSSetValue(L+'.objectives.0.id',B);if(C)  LMSSetValue(L+'.time',C);if(D)  LMSSetValue(L+'.type',D);if(E) LMSSetValue(L+'.correct_responses.0.pattern',E);LMSSetValue(L+'.weighting',F);if(G) LMSSetValue(L+'.student_response',G);if(H)  LMSSetValue(L+'.result',H);if(I)  LMSSetValue(L+'.latency',I);if(J)  LMSSetValue(L+'.text',J);};
